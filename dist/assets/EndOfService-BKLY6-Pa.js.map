{"version":3,"file":"EndOfService-BKLY6-Pa.js","sources":["../../src/pages/employees/EndOfService.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { EmployeeService } from '../../services/api/employees';\r\nimport type { Employee } from '../../types/employee';\r\nimport Decimal from 'decimal.js';\r\n\r\nexport const EndOfServicePage: React.FC = () => {\r\n  const [employees, setEmployees] = useState<Employee[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [recalcLoading, setRecalcLoading] = useState(false);\r\n\r\n  useEffect(() => { (async () => {\r\n    const emps = await EmployeeService.getActiveEmployees();\r\n    setEmployees(emps);\r\n    setLoading(false);\r\n  })(); }, []);\r\n\r\n  const recalc = async () => {\r\n    setRecalcLoading(true);\r\n    await EmployeeService.recalcEndOfServiceAll();\r\n    const emps = await EmployeeService.getActiveEmployees();\r\n    setEmployees(emps);\r\n    setRecalcLoading(false);\r\n  };\r\n\r\n  const permanent = employees.filter(e=> e.employeeType==='Permanent');\r\n  const totalLiability = permanent.reduce((s,e)=> s.plus(e.endOfService.gratuityAmount), new Decimal(0));\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-start justify-between\">\r\n        <div>\r\n          <h1 className=\"text-xl font-semibold\">End of Service (EOS) Summary</h1>\r\n          <p className=\"text-xs text-gray-500 max-w-xl\">Gratuity approximated per Qatar Labor Law Article 54: 3 weeks basic salary per year for first 5 years, 4 weeks thereafter. This is a simplified estimator and should be validated against current legislation.</p>\r\n        </div>\r\n        <button onClick={recalc} disabled={recalcLoading} className=\"px-3 py-1.5 rounded text-xs bg-qatar-maroon text-white disabled:opacity-60\">{recalcLoading ? 'Recalculating…' : 'Recalculate'}</button>\r\n      </div>\r\n      {loading ? <div className=\"text-sm text-gray-500\">Loading…</div> : (\r\n        <>\r\n          <div className=\"text-sm font-medium\">Total EOS Liability: <span className=\"text-qatar-maroon font-semibold\">{totalLiability.toFixed(2)}</span></div>\r\n          <div className=\"overflow-x-auto border rounded bg-white\">\r\n            <table className=\"min-w-full text-sm\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"px-3 py-2 text-left\">Employee</th>\r\n                  <th className=\"px-3 py-2 text-right\">Years of Service</th>\r\n                  <th className=\"px-3 py-2 text-right\">Basic Salary</th>\r\n                  <th className=\"px-3 py-2 text-right\">Eligible Amount</th>\r\n                  <th className=\"px-3 py-2 text-left\">Last Calculation</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {permanent.map(e => (\r\n                  <tr key={e.id} className=\"border-b last:border-0\">\r\n                    <td className=\"px-3 py-2 font-medium whitespace-nowrap\">{e.personalInfo.firstName} {e.personalInfo.lastName}</td>\r\n                    <td className=\"px-3 py-2 text-right\">{(e.endOfService.serviceYears || 0).toFixed(2)}</td>\r\n                    <td className=\"px-3 py-2 text-right\">{(e.compensation as any).basicSalary?.toFixed ? (e.compensation as any).basicSalary.toFixed(2) : '0.00'}</td>\r\n                    <td className=\"px-3 py-2 text-right font-semibold\">{(e.endOfService.gratuityAmount || 0).toFixed(2)}</td>\r\n                    <td className=\"px-3 py-2 text-left text-xs\">—</td>\r\n                  </tr>\r\n                ))}\r\n                {permanent.length === 0 && <tr><td colSpan={5} className=\"px-3 py-6 text-center text-gray-500\">No permanent employees.</td></tr>}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\nexport default EndOfServicePage;\r\n"],"names":["EndOfServicePage","employees","setEmployees","useState","loading","setLoading","recalcLoading","setRecalcLoading","useEffect","emps","EmployeeService","recalc","permanent","e","totalLiability","s","Decimal","jsxs","jsx","Fragment"],"mappings":"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"}