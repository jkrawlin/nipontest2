{"version":3,"file":"CustomerGenerateInvoice-DmKw5V-W.js","sources":["../../src/pages/customers/CustomerGenerateInvoice.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { CustomerService } from '../../services/api/customers';\r\nimport { InvoiceService } from '../../services/api/invoices';\r\nimport type { Customer, CustomerInvoice } from '../../types/customer';\r\nimport { Button } from '../../components/ui/button';\r\nimport { Card } from '../../components/ui/card';\r\n\r\nexport const CustomerGenerateInvoice: React.FC = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const [customer, setCustomer] = useState<Customer | null>(null);\r\n  const [invoice, setInvoice] = useState<CustomerInvoice | null>(null);\r\n  const [periodStart, setPeriodStart] = useState<string>(new Date(new Date().getFullYear(), new Date().getMonth(), 1).toISOString().substring(0,10));\r\n  const [periodEnd, setPeriodEnd] = useState<string>(new Date().toISOString().substring(0,10));\r\n\r\n  useEffect(()=> {\r\n    if (id) {\r\n      setCustomer(CustomerService.getById(id) || null);\r\n    }\r\n  }, [id]);\r\n\r\n  if (!customer) return <div className=\"p-6 text-sm\">Loading...</div>;\r\n\r\n  const generate = () => {\r\n    const draft = InvoiceService.createDraft({ customerId: customer.id, periodStart, periodEnd });\r\n    if (draft) setInvoice(draft);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-semibold\">Generate Invoice</h1>\r\n          <p className=\"text-sm text-gray-600\">{customer.companyInfo.name}</p>\r\n        </div>\r\n        <Button variant=\"outline\" onClick={()=> navigate(-1)}>Back</Button>\r\n      </div>\r\n      <Card className=\"p-6 space-y-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm\">\r\n          <div><label className=\"block text-[11px] uppercase mb-1\">Period Start</label><input type=\"date\" className=\"w-full border rounded px-2 py-1\" value={periodStart} onChange={e=> setPeriodStart(e.target.value)} /></div>\r\n          <div><label className=\"block text-[11px] uppercase mb-1\">Period End</label><input type=\"date\" className=\"w-full border rounded px-2 py-1\" value={periodEnd} onChange={e=> setPeriodEnd(e.target.value)} /></div>\r\n          <div className=\"flex items-end\"><Button onClick={generate}>Draft Invoice</Button></div>\r\n        </div>\r\n        {invoice && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex justify-between text-sm\"><div>Invoice #</div><div className=\"font-medium\">{invoice.invoiceNumber}</div></div>\r\n            <table className=\"w-full text-xs\">\r\n              <thead><tr className=\"border-b\"><th className=\"text-left py-2\">Description</th><th className=\"text-right py-2\">Qty</th><th className=\"text-right py-2\">Rate</th><th className=\"text-right py-2\">Amount</th></tr></thead>\r\n              <tbody>{invoice.lines.map((l,i)=>(<tr key={i} className=\"border-b\"><td className=\"py-1\">{l.description}</td><td className=\"py-1 text-right\">{l.quantity}</td><td className=\"py-1 text-right\">{l.unitRate.toFixed(2)}</td><td className=\"py-1 text-right\">{l.amount.toFixed(2)}</td></tr>))}</tbody>\r\n              <tfoot>\r\n                <tr><td colSpan={3} className=\"text-right py-1\">Subtotal</td><td className=\"py-1 text-right font-medium\">{invoice.subtotal.toFixed(2)}</td></tr>\r\n                <tr><td colSpan={3} className=\"text-right py-1\">VAT</td><td className=\"py-1 text-right font-medium\">{invoice.vatAmount.toFixed(2)}</td></tr>\r\n                <tr><td colSpan={3} className=\"text-right py-1\">Total</td><td className=\"py-1 text-right font-bold\">{invoice.total.toFixed(2)}</td></tr>\r\n              </tfoot>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomerGenerateInvoice;\r\n"],"names":["CustomerGenerateInvoice","id","useParams","navigate","useNavigate","customer","setCustomer","useState","invoice","setInvoice","periodStart","setPeriodStart","periodEnd","setPeriodEnd","useEffect","CustomerService","generate","draft","InvoiceService","jsxs","jsx","Button","Card","e","l","i"],"mappings":"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"}