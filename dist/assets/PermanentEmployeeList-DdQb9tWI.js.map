{"version":3,"file":"PermanentEmployeeList-DdQb9tWI.js","sources":["../../src/pages/employees/PermanentEmployeeList.tsx"],"sourcesContent":["import React,{useEffect,useState} from 'react';\r\nimport { PermanentEmployee } from '../../types/employee';\r\nimport { PermanentEmployeeService } from '../../services/api/permanentEmployees';\r\nimport { getAllPermanentEmployeesFS } from '../../services/firestore/employees';\r\nconst USE_FS = import.meta.env.VITE_DATA_BACKEND === 'firestore';\r\nimport { Card } from '../../components/ui/card';\r\nimport { Badge } from '../../components/ui/badge';\r\nimport { Users, FileWarning, DollarSign } from 'lucide-react';\r\nimport { Dialog } from '../../components/ui/dialog';\r\nimport { EmployeeDetails } from '../../components/features/employees/EmployeeDetails';\r\nimport type { Employee } from '../../types/employee';\r\n\r\nexport const PermanentEmployeeList: React.FC = () => {\r\n  const [employees,setEmployees]=useState<PermanentEmployee[]>([]);\r\n  const [stats,setStats]=useState({total:0,active:0,onLeave:0,totalSalary:0});\r\n  const [openDetails, setOpenDetails] = useState(false);\r\n  const [selected, setSelected] = useState<Employee | null>(null);\r\n  useEffect(()=>{ (async ()=>{ const data = USE_FS ? await getAllPermanentEmployeesFS() : PermanentEmployeeService.getAll(); setEmployees(data); setStats({ total:data.length, active:data.filter(e=>e.status==='Active').length, onLeave:data.filter(e=>e.status==='On Leave').length, totalSalary:data.reduce((s,e)=> s+ e.compensation.totalMonthlySalary,0)}); })(); },[]);\r\n  return <div className=\"p-6 space-y-6\">\r\n    <div>\r\n      <h1 className=\"text-2xl font-semibold\">Permanent Employees</h1>\r\n      <p className=\"text-xs text-gray-500\">Full-time staff with Qatar IDs & monthly payroll</p>\r\n    </div>\r\n    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n      <Card className=\"p-4\"><div className=\"flex justify-between\"><div><p className=\"text-xs text-gray-500\">Total</p><p className=\"text-xl font-bold\">{stats.total}</p></div><Users className=\"w-6 h-6 text-blue-600\"/></div></Card>\r\n      <Card className=\"p-4\"><div className=\"flex justify-between\"><div><p className=\"text-xs text-gray-500\">Active</p><p className=\"text-xl font-bold\">{stats.active}</p></div><Users className=\"w-6 h-6 text-green-600\"/></div></Card>\r\n      <Card className=\"p-4\"><div className=\"flex justify-between\"><div><p className=\"text-xs text-gray-500\">On Leave</p><p className=\"text-xl font-bold\">{stats.onLeave}</p></div><FileWarning className=\"w-6 h-6 text-amber-600\"/></div></Card>\r\n      <Card className=\"p-4\"><div className=\"flex justify-between\"><div><p className=\"text-xs text-gray-500\">Monthly Payroll</p><p className=\"text-xl font-bold\">QAR {stats.totalSalary.toFixed(0)}</p></div><DollarSign className=\"w-6 h-6 text-green-600\"/></div></Card>\r\n    </div>\r\n    <div className=\"overflow-x-auto border rounded bg-white\">\r\n      <table className=\"min-w-full text-sm\">\r\n        <thead className=\"bg-gray-50\"><tr><th className=\"px-3 py-2 text-left\">Code</th><th className=\"px-3 py-2 text-left\">Name</th><th className=\"px-3 py-2 text-left\">Position</th><th className=\"px-3 py-2 text-left\">Qatar ID</th><th className=\"px-3 py-2 text-left\">ID Expiry</th><th className=\"px-3 py-2 text-right\">Salary</th><th className=\"px-3 py-2 text-left\">Status</th></tr></thead>\r\n        <tbody>\r\n          {employees.map(e=>{ const expDays=Math.floor((new Date(e.documents.qatarId.expiryDate).getTime()-Date.now())/(1000*60*60*24)); return <tr key={e.id} className=\"border-b last:border-0\"> \r\n            <td className=\"px-3 py-2\">{e.employeeCode}</td>\r\n            <td className=\"px-3 py-2 whitespace-nowrap\">\r\n              <button className=\"text-indigo-600 hover:underline font-medium\" onClick={()=> { setSelected(e as Employee); setOpenDetails(true); }}>\r\n                {e.personalInfo.firstName} {e.personalInfo.lastName}\r\n              </button>\r\n            </td>\r\n            <td className=\"px-3 py-2\">{e.employment.position}</td>\r\n            <td className=\"px-3 py-2\">{e.documents.qatarId.number}</td>\r\n            <td className=\"px-3 py-2\"><Badge variant={expDays<0? 'destructive': expDays<30? 'outline': 'secondary'}>{expDays<0? 'EXPIRED': expDays+ 'd'}</Badge></td>\r\n            <td className=\"px-3 py-2 text-right\">{e.compensation.totalMonthlySalary.toFixed(0)}</td>\r\n            <td className=\"px-3 py-2\"><Badge variant={e.status==='Active'? 'secondary': 'outline'}>{e.status}</Badge></td>\r\n          </tr>; })}\r\n          {employees.length===0 && <tr><td colSpan={7} className=\"px-3 py-6 text-center text-gray-500\">No records.</td></tr>}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    <Dialog open={openDetails} onClose={()=> setOpenDetails(false)} title={selected ? `${selected.personalInfo.firstName} ${selected.personalInfo.lastName}` : 'Employee Details'} size=\"lg\">\r\n      {selected && (<EmployeeDetails employee={selected} />)}\r\n    </Dialog>\r\n  </div>;\r\n};\r\nexport default PermanentEmployeeList;\r\n"],"names":["PermanentEmployeeList","employees","setEmployees","useState","stats","setStats","openDetails","setOpenDetails","selected","setSelected","useEffect","data","getAllPermanentEmployeesFS","e","s","jsxs","jsx","Card","Users","FileWarning","DollarSign","expDays","Badge","Dialog","EmployeeDetails"],"mappings":"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"}