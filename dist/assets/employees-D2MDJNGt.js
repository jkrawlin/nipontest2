import{g as u,b as d}from"./employees-DNNZe7Q5.js";function f(t,a){if(!a)return t;const r=a.toLowerCase();return t.filter(n=>n.employeeCode.toLowerCase().includes(r)||n.personalInfo.firstName.toLowerCase().includes(r)||n.personalInfo.lastName.toLowerCase().includes(r))}function g(t,a,r){const n=Date.now(),p=864e5,o=[],s=(e,m,l,y)=>{if(!l)return;const i=Math.floor((new Date(l).getTime()-n)/p);if(i>r)return;let c="valid";i<0?c="expired":i<=15?c="critical":i<=45&&(c="warning"),o.push({employeeId:e.id,employeeType:e.employeeType,employeeName:`${e.personalInfo.firstName} ${e.personalInfo.lastName}`,documentType:m,documentNumber:y,expiryDate:l,daysRemaining:i,status:c})};return t.forEach(e=>{s(e,"Qatar ID",e.documents.qatarId.expiryDate,e.documents.qatarId.number),s(e,"Passport",e.documents.passport.expiryDate,e.documents.passport.number),s(e,"Visa",e.documents.visa.expiryDate,e.documents.visa.number),s(e,"Health Card",e.documents.healthCard.expiryDate,e.documents.healthCard.number)}),a.forEach(e=>{e.documents.qatarId&&s(e,"Qatar ID",e.documents.qatarId.expiryDate,e.documents.qatarId.number),s(e,"Passport",e.documents.passport.expiryDate,e.documents.passport.number),e.documents.visa&&s(e,"Visa",e.documents.visa.expiryDate,e.documents.visa.number),e.documents.workPermit&&s(e,"Work Permit",e.documents.workPermit.expiryDate,e.documents.workPermit.number)}),o.sort((e,m)=>e.daysRemaining-m.daysRemaining)}const h={initialize(){},async list(t={}){const a=[...await u(),...await d()],r=f(a,t.search),n=t.pageSize??20,o=((t.page&&t.page>0?t.page:1)-1)*n,s=o+n;return{employees:r.slice(o,s),count:r.length}},async getAllEmployees(){return[...await u(),...await d()]},async getActiveEmployees(){return(await this.getAllEmployees()).filter(t=>t.status==="Active")},async getExpiringDocuments(t=90){{const a=await u(),r=await d();return g(a,r,t)}},async recalcEndOfServiceAll(){},async create(){throw new Error("Use PermanentEmployeeService.create or TemporaryEmployeeService.create")},async update(){throw new Error("Use specific service update method")},async getById(t){return(await this.getAllEmployees()).find(a=>a.id===t)||null}};export{h as E};
//# sourceMappingURL=employees-D2MDJNGt.js.map
